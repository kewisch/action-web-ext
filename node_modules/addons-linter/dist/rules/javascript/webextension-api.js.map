{"version":3,"file":"rules/javascript/webextension-api.js","mappings":"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","sources":["webpack://addons-linter/./src/utils.js","webpack://addons-linter/external node-commonjs \"url\"","webpack://addons-linter/external commonjs \"upath\"","webpack://addons-linter/external commonjs \"jed\"","webpack://addons-linter/external commonjs \"semver\"","webpack://addons-linter/external commonjs \"common-tags\"","webpack://addons-linter/external commonjs \"os-locale\"","webpack://addons-linter/./src/logger.js","webpack://addons-linter/external commonjs \"pino\"","webpack://addons-linter/./src/const.js","webpack://addons-linter/./src/schema/browser-apis.js","webpack://addons-linter/./src/schema/imported/index.js","webpack://addons-linter/webpack/bootstrap","webpack://addons-linter/./src/rules/javascript/webextension-api.js"],"sourcesContent":["import url from 'url';\n\nimport upath from 'upath';\nimport Jed from 'jed';\nimport semver from 'semver';\nimport { oneLine } from 'common-tags';\nimport osLocale from 'os-locale';\n\nimport log from 'logger';\nimport { PACKAGE_TYPES, LOCAL_PROTOCOLS } from 'const';\n\n/* global nodeRequire, localesRoot */\n\nconst SOURCE_MAP_RE = /\\/\\/[#@]\\s(source(?:Mapping)?URL)=\\s*(\\S+)/;\n\n// Represents an error condition related to a user error (e.g. an invalid\n// configuration option passed to the linter class, usually through the\n// command line arguments).\n//\n// In bin/addons-linter instances of this error are recognized through the\n// error name property and by default they will be logged on stderr as\n// plain error messages and the error stack trace omitted (unless explicitly\n// requested by passing --stack as an additional CLI options, useful for\n// debugging reasons).\nexport class AddonsLinterUserError extends Error {\n  get name() {\n    return 'AddonsLinterUserError';\n  }\n}\n\nexport function errorParamsToUnsupportedVersionRange(errorParams) {\n  const { min_manifest_version, max_manifest_version } = errorParams || {};\n  if (min_manifest_version != null || max_manifest_version != null) {\n    return [\n      min_manifest_version ? `< ${min_manifest_version}` : undefined,\n      max_manifest_version ? `> ${max_manifest_version}` : undefined,\n    ]\n      .filter((e) => e !== undefined)\n      .join(', ');\n  }\n\n  return '';\n}\n\nexport function normalizePath(iconPath) {\n  // Convert the icon path to a URL so we can strip any fragments and resolve\n  // . and .. automatically. We need an absolute URL to use as a base so we're\n  // using https://example.com/.\n  const { pathname } = new URL(iconPath, 'https://example.com/');\n\n  // Convert filename to unix path separator (as the ones stored\n  // into the scanned files map).\n  return upath.toUnix(decodeURIComponent(pathname).slice(1));\n}\n\n/*\n * Takes an AST node and returns the root property.\n *\n * example: foo().bar.baz() will return the AST node for foo.\n */\nexport function getRootExpression(node) {\n  let root = node.callee;\n\n  // If we encounter a member, grab the parent\n  if (node.callee.type === 'MemberExpression') {\n    let parent = node.callee.object;\n    while (parent.type !== 'Identifier') {\n      if (parent.callee.type === 'MemberExpression') {\n        parent = parent.callee.object;\n      } else {\n        parent = parent.callee;\n      }\n    }\n    root = parent;\n  }\n\n  return root;\n}\n\n/*\n * Returns the name of the reference node passed.\n *\n * example: var foo = document;\n *  The node for foo will return 'document'\n */\nexport function getNodeReference(context, node) {\n  const { variables } = context.getScope();\n  let scopeVar;\n\n  // Just return the value if the node passed in is a reference to a literal.\n  if (typeof node === 'undefined' || node.type === 'Literal') {\n    return node;\n  }\n\n  // Finds variable reference in current scope.\n  for (let i = 0; i < variables.length; i++) {\n    const variable = variables[i];\n    if (variable.name === node.name) {\n      scopeVar = variable;\n      break;\n    }\n  }\n\n  if (\n    scopeVar &&\n    scopeVar.defs &&\n    scopeVar.defs[0] &&\n    scopeVar.defs[0].parent &&\n    scopeVar.defs[0].parent.parent &&\n    scopeVar.defs[0].parent.parent.body\n  ) {\n    // This represents all occurrences of the variable\n    const occurances = scopeVar.defs[0].parent.parent.body;\n    let lastAssignment;\n\n    if (occurances instanceof Array) {\n      occurances.forEach((occurance) => {\n        if (\n          occurance.type === 'VariableDeclaration' &&\n          occurance.declarations[0].init !== null\n        ) {\n          // Get what the name of what it was assigned to or the raw\n          // value depending on the initalization\n          lastAssignment = occurance.declarations[0].init;\n        } else if (\n          occurance.type === 'ExpressionStatement' &&\n          occurance.expression.type === 'AssignmentExpression'\n        ) {\n          // Get the right hand side of the assignment\n          lastAssignment = occurance.expression.right;\n        }\n      });\n    }\n\n    // Return the name of the first definition of the variable which\n    // corresponds to the node passed in.\n    if (lastAssignment) {\n      return lastAssignment;\n    }\n  }\n\n  // If that variable doesn't exist in scope, then just return the node's\n  // name.\n  return node;\n}\n\n/*\n * Get a variable from a eslint context object if it exists, otherwise\n * undefined.\n */\nexport function getVariable(context, name) {\n  const { variables } = context.getScope();\n  let result;\n  variables.forEach((variable) => {\n    if (\n      variable.name === name &&\n      variable.defs &&\n      variable.defs[0] &&\n      variable.defs[0].name &&\n      variable.defs[0].name.parent\n    ) {\n      result = variable.defs[0].name.parent.init;\n    }\n  });\n  return result;\n}\n\nexport function getLocale() {\n  return osLocale.sync();\n}\n\nexport function getI18Data(locale) {\n  let i18ndata = {};\n  try {\n    // eslint-disable-next-line global-require, import/no-dynamic-require\n    i18ndata = nodeRequire(`${localesRoot}/${locale}/messages.js`);\n  } catch (err) {\n    log.info('Initialize locales using extract-locales command');\n  }\n\n  return i18ndata;\n}\n\n/*\n * Gettext utils. Used for translating strings.\n */\nexport function buildI18nObject(i18nData) {\n  const _jed = new Jed(i18nData);\n\n  return {\n    jed: _jed,\n    getI18Data,\n    _: (str) => {\n      return _jed.gettext(str);\n    },\n    gettext: (str) => {\n      return _jed.gettext(str);\n    },\n    sprintf: (fmt, args) => {\n      return _jed.sprintf(fmt, args);\n    },\n  };\n}\n\nexport const i18n = buildI18nObject(getI18Data(getLocale()));\n\n/*\n * Check the minimum node version is met\n */\nexport async function checkMinNodeVersion(minVersion, _process = process) {\n  // eslint-disable-next-line no-param-reassign\n  minVersion = minVersion || '0.12.0';\n  if (!semver.gte(_process.version, minVersion)) {\n    throw new Error(oneLine`Node version must be ${minVersion} or\n                    greater. You are using ${_process.version}.`);\n  }\n}\n\nexport function getPackageTypeAsString(numericPackageType) {\n  const packageKeys = Object.keys(PACKAGE_TYPES);\n  for (let i = 0; i < packageKeys.length; i++) {\n    const packageType = packageKeys[i];\n    if (parseInt(numericPackageType, 10) === PACKAGE_TYPES[packageType]) {\n      return packageType;\n    }\n  }\n  throw new Error(`Invalid package type constant \"${numericPackageType}\"`);\n}\n\n/*\n * Looks through all exported functions and returns only\n * \"public\" *functions* that aren't prefixed with an _\n *\n * Used for ignoring private functions and constants in rules files.\n * Rules can have private functions we don't run; anything that\n * starts with an \"_\" shouldn't be returned.\n *\n * This exists because we export private functions in rule files\n * for testing.\n */\nexport function ignorePrivateFunctions(list) {\n  const filteredList = {};\n\n  Object.keys(list).forEach((functionName) => {\n    if (\n      functionName.startsWith('_') === false &&\n      typeof list[functionName] === 'function'\n    ) {\n      filteredList[functionName] = list[functionName];\n    }\n  });\n\n  return filteredList;\n}\n\n/*\n * Check a filename to make sure it's valid; used by scanners so we never\n * accept new scanners that don't specify which file they're referencing.\n */\nexport function ensureFilenameExists(filename) {\n  if (typeof filename !== 'string' || filename.length < 1) {\n    throw new Error('Filename is required');\n  }\n}\n\nexport function isLocalUrl(urlInput) {\n  const parsedUrl = url.parse(urlInput);\n  const { protocol, path } = parsedUrl;\n\n  // Check protocol is chrome: or resource: if set.\n  // Details on the chrome protocol are here: https://goo.gl/W52T0Q\n  // Details on resource protocol are here: https://goo.gl/HHqeJA\n  if (protocol && !LOCAL_PROTOCOLS.includes(protocol)) {\n    return false;\n  }\n  // Disallow protocol-free remote urls.\n  if (path.startsWith('//')) {\n    return false;\n  }\n  return true;\n}\n\nexport function apiToMessage(string) {\n  return string\n    .replace(/^extension/, 'ext')\n    .replace(/\\./g, '_')\n    .toUpperCase()\n    .substr(0, 25);\n}\n\nexport function isBrowserNamespace(string) {\n  return ['browser', 'chrome'].includes(string);\n}\n\nexport function parseCspPolicy(policy) {\n  if (!policy) {\n    return {};\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  policy = policy.toLowerCase();\n\n  const parsedPolicy = {};\n  const directives = policy.split(';');\n\n  directives.forEach((directive) => {\n    // eslint-disable-next-line no-param-reassign\n    directive = directive.trim();\n    const tokens = directive.split(/\\s+/);\n\n    const name = tokens[0];\n\n    if (name) {\n      parsedPolicy[name] = tokens.slice(1, tokens.length);\n    }\n  });\n\n  return parsedPolicy;\n}\n\nexport function getLineAndColumnFromMatch(match) {\n  const matchedLines = match.input.substr(0, match.index).split('\\n');\n  const matchedColumn = matchedLines.slice(-1)[0].length + 1;\n  const matchedLine = matchedLines.length;\n\n  return { matchedLine, matchedColumn };\n}\n\n/**\n * Determines if the source text is minified.\n * Using the percentage no. of the indented lines from a sample set of lines\n * to determine if the js file is minified.\n * Inspired by code for the Firefox Developer Toolbar.\n */\nexport function couldBeMinifiedCode(code) {\n  // Fast exit if `code` is empty. Could happen in tests, but also in real\n  // files.\n  if (!code) {\n    return false;\n  }\n\n  // If there's a source map reference it's very certainly minified code.\n  if (SOURCE_MAP_RE.test(code)) {\n    return true;\n  }\n\n  // Number of lines to look at, taken from the head of the code.\n  const sampleSize = 30;\n\n  // Threshold in percent of indented lines to mark a file as not\n  // minified.\n  const indentCountThreshold = 20; // percentage\n\n  // Length of a line that looks suspicious of being minified\n  const hugeLinesLength = 500;\n\n  // Number of huge lines to also mark a file as potentially minified\n  // Hint: Minified AngularJS has 12 lines, jQuery 4\n  const hugeLinesThreshold = 4;\n\n  let lineEndIndex = 0;\n  let lineStartIndex = 0;\n  let lines = 1;\n  let indentCount = 0;\n  let hugeLinesCount = 0;\n\n  // Strip comments.\n  const normalizedCode = code.replace(/\\/\\*[\\S\\s]*?\\*\\/|\\/\\/.+/g, '');\n\n  while (lines < sampleSize) {\n    lineEndIndex = normalizedCode.indexOf('\\n', lineStartIndex);\n\n    if (lineEndIndex === -1) {\n      break;\n    }\n\n    const currentLine = normalizedCode.slice(lineStartIndex, lineEndIndex);\n\n    if (/^\\s+/.test(currentLine)) {\n      indentCount++;\n    }\n\n    if (currentLine.length >= hugeLinesLength) {\n      hugeLinesCount++;\n    }\n\n    lineStartIndex = lineEndIndex + 1;\n    lines++;\n  }\n\n  return (\n    (indentCount / lines) * 100 < indentCountThreshold ||\n    hugeLinesCount > hugeLinesThreshold\n  );\n}\n\nexport function firefoxStrictMinVersion(manifestJson) {\n  if (\n    manifestJson.applications &&\n    manifestJson.applications.gecko &&\n    manifestJson.applications.gecko.strict_min_version &&\n    typeof manifestJson.applications.gecko.strict_min_version === 'string'\n  ) {\n    return parseInt(\n      manifestJson.applications.gecko.strict_min_version.split('.')[0],\n      10\n    );\n  }\n  return null;\n}\n\nexport function basicCompatVersionComparison(versionAdded, minVersion) {\n  const asNumber = parseInt(versionAdded, 10);\n  return !Number.isNaN(asNumber) && asNumber > minVersion;\n}\n\n/**\n * @param {*} supportInfo - bcd support info of a feature\n * @returns {string|boolean} The first version number to support the feature\n *          or a boolean indicating if the feature is supported at all. We do\n *          not consider any holes in the supported versions, only the first\n *          stable version is taken into account.\n */\nexport function firstStableVersion(supportInfo) {\n  let supportInfoArray = supportInfo;\n  if (!Array.isArray(supportInfo)) {\n    supportInfoArray = [supportInfo];\n  }\n  return supportInfoArray.reduce((versionAdded, supportEntry) => {\n    if (\n      !Object.prototype.hasOwnProperty.call(supportEntry, 'flags') &&\n      (!versionAdded ||\n        (supportEntry.version_added &&\n          !basicCompatVersionComparison(\n            supportEntry.version_added,\n            parseInt(versionAdded, 10)\n          )))\n    ) {\n      return supportEntry.version_added;\n    }\n    return versionAdded;\n  }, false);\n}\n\nexport function isCompatible(bcd, path, minVersion, application) {\n  const steps = path.split('.');\n  let { api } = bcd.webextensions;\n  for (const step of steps) {\n    if (Object.prototype.hasOwnProperty.call(api, step)) {\n      api = api[step];\n    } else {\n      break;\n    }\n  }\n  // API namespace may be undocumented or not implemented, ignore in that case.\n  if (api.__compat) {\n    const supportInfo = api.__compat.support[application];\n    const versionAdded = firstStableVersion(supportInfo);\n    return !basicCompatVersionComparison(versionAdded, minVersion);\n  }\n  return true;\n}\n\nexport function createCompatibilityRule(\n  application,\n  message,\n  context,\n  bcd,\n  hasBrowserApi\n) {\n  const { addonMetadata } = context.settings;\n  const minVersion =\n    addonMetadata &&\n    firefoxStrictMinVersion({\n      applications: {\n        gecko: {\n          strict_min_version: context.settings.addonMetadata.firefoxMinVersion,\n        },\n      },\n    });\n  if (minVersion) {\n    return {\n      MemberExpression(node) {\n        if (\n          !node.computed &&\n          node.object.object &&\n          isBrowserNamespace(node.object.object.name)\n        ) {\n          const namespace = node.object.property.name;\n          const property = node.property.name;\n          const api = `${namespace}.${property}`;\n          if (\n            hasBrowserApi(namespace, property, addonMetadata) &&\n            !isCompatible(bcd, api, minVersion, application)\n          ) {\n            context.report(node, message.messageFormat, {\n              api,\n              minVersion: addonMetadata.firefoxMinVersion,\n            });\n          }\n        }\n      },\n    };\n  }\n  return {};\n}\n","module.exports = require(\"url\");","module.exports = require(\"upath\");","module.exports = require(\"jed\");","module.exports = require(\"semver\");","module.exports = require(\"common-tags\");","module.exports = require(\"os-locale\");","import pino from 'pino';\n\nexport function createLogger(_process = process) {\n  const level = _process.env.LOG_LEVEL || 'fatal';\n  return pino(\n    {\n      name: 'AddonLinterJS',\n      level,\n    },\n    process.stdout\n  );\n}\n\nexport default createLogger();\n","module.exports = require(\"pino\");","export const ESLINT_ERROR = 2;\nexport const ESLINT_WARNING = 1;\n\nconst NO_UNSANITIZED_OPTIONS = {\n  variableTracing: false,\n  // Disable escapers (Sanitizer.escapeHTML, escapeHTML) and unwrappers\n  // (Sanitizer.unwrapSafeHTML, unwrapSafeHTML) which are allowed by default by\n  // this plugin.\n  escape: { taggedTemplates: [], methods: [] },\n};\n\n// 3rd party / eslint-internal rules\nexport const EXTERNAL_RULE_MAPPING = {\n  'no-eval': [ESLINT_WARNING, { allowIndirect: false }],\n  'no-implied-eval': ESLINT_WARNING,\n  'no-new-func': ESLINT_WARNING,\n  'no-unsanitized/method': [ESLINT_WARNING, NO_UNSANITIZED_OPTIONS],\n  'no-unsanitized/property': [ESLINT_WARNING, NO_UNSANITIZED_OPTIONS],\n};\n\nexport const ESLINT_RULE_MAPPING = {\n  'deprecated-entities': ESLINT_WARNING,\n  'event-listener-fourth': ESLINT_WARNING,\n  'global-require-arg': ESLINT_WARNING,\n  'opendialog-nonlit-uri': ESLINT_WARNING,\n  'opendialog-remote-uri': ESLINT_WARNING,\n  'webextension-api': ESLINT_WARNING,\n  'webextension-deprecated-api': ESLINT_WARNING,\n  'webextension-unsupported-api': ESLINT_WARNING,\n  'content-scripts-file-absent': ESLINT_ERROR,\n  'webextension-api-compat': ESLINT_WARNING,\n  'webextension-api-compat-android': ESLINT_WARNING,\n  ...EXTERNAL_RULE_MAPPING,\n};\n\nexport const VALIDATION_ERROR = 'error';\nexport const VALIDATION_NOTICE = 'notice';\nexport const VALIDATION_WARNING = 'warning';\n\nexport const ESLINT_TYPES = {\n  0: VALIDATION_NOTICE,\n  1: VALIDATION_WARNING,\n  2: VALIDATION_ERROR,\n};\n\nexport const MESSAGE_TYPES = [\n  VALIDATION_ERROR,\n  VALIDATION_NOTICE,\n  VALIDATION_WARNING,\n];\n\n// Package type constants.\nexport const PACKAGE_ANY = 0;\nexport const PACKAGE_EXTENSION = 1;\nexport const PACKAGE_THEME = 2;\nexport const PACKAGE_DICTIONARY = 3;\nexport const PACKAGE_LANGPACK = 4;\nexport const PACKAGE_SEARCHPROV = 5;\nexport const PACKAGE_MULTI = 1; // A multi extension is an extension\nexport const PACKAGE_SUBPACKAGE = 7;\n\nexport const PACKAGE_TYPES = {\n  PACKAGE_ANY,\n  PACKAGE_EXTENSION,\n  PACKAGE_THEME,\n  PACKAGE_DICTIONARY,\n  PACKAGE_LANGPACK,\n  PACKAGE_SEARCHPROV,\n  PACKAGE_MULTI,\n  PACKAGE_SUBPACKAGE,\n};\n\nexport const LOCAL_PROTOCOLS = ['chrome:', 'resource:'];\n\nexport const MANIFEST_JSON = 'manifest.json';\n\n// The manifest_version value to use to complete the validation if an explicit one\n// was missing from the extension manifest.json (but we will still be collecting the\n// error for the missing manifest_version property, because it is mandatory).\nexport const MANIFEST_VERSION_DEFAULT = 2;\n\n// Default min/max_manifest_version values used for schema definitions that do not\n// have an explicit one on their own.\nexport const MANIFEST_VERSION_MIN = 2;\nexport const MANIFEST_VERSION_MAX = 3;\n\n// This is the limit in megabytes of a file we will parse (eg. CSS, JS, etc.)\n// A singular CSS/JS file over 4MB seems bad and may actually be full of data\n// best stored in JSON/some other data format rather than code.\n// https://github.com/mozilla/addons-linter/issues/730\n// We increased this limit from 2MB to 4MB as per:\n// https://github.com/mozilla/addons/issues/181\n//\n// We should be careful about increasing this any further.\nexport const MAX_FILE_SIZE_TO_PARSE_MB = 4;\n\nexport const HIDDEN_FILE_REGEX = /^__MACOSX\\//;\nexport const FLAGGED_FILE_REGEX = /thumbs\\.db$|\\.DS_Store$|\\.orig$|\\.old$|~$/i;\nexport const ALREADY_SIGNED_REGEX = /^META-INF\\/manifest\\.mf/;\nexport const PERMS_DATAPATH_REGEX =\n  /^\\/(permissions|optional_permissions|host_permissions)\\/([\\d+])/;\n\nexport const RESERVED_FILENAMES = ['mozilla-recommendation.json'];\n\nexport const FLAGGED_FILE_EXTENSIONS = [\n  '.class',\n  '.dll',\n  '.dylib',\n  '.exe',\n  '.jar',\n  '.sh',\n  '.so',\n  '.swf',\n];\n\nexport const IMAGE_FILE_EXTENSIONS = [\n  'jpg',\n  'jpeg',\n  'webp',\n  'gif',\n  'png',\n  'svg',\n];\n\nexport const FILE_EXTENSIONS_TO_MIME = {\n  svg: 'image/svg+xml',\n  gif: 'image/gif',\n  jpg: 'image/jpeg',\n  jpeg: 'image/jpeg',\n  png: 'image/png',\n  webp: 'image/webp',\n};\n\n// Unique list of mime types for the allowed static theme images.\nexport const STATIC_THEME_IMAGE_MIMES = [\n  ...new Set(Object.values(FILE_EXTENSIONS_TO_MIME)),\n];\n\n// Mapping of \"schema data paths\" of the deprecated properties that we\n// issue warnings for.\n// If the value is `null` we will be using the `deprecated` message\n// from the schema. Otherwise `code`, `message` and `description` will be taken\n// from the object provided.\n// Note that we have to use the constants name as we can't import\n// the message object here.\nexport const DEPRECATED_MANIFEST_PROPERTIES = {\n  '/theme/images/headerURL': 'MANIFEST_THEME_LWT_ALIAS',\n  '/theme/colors/accentcolor': 'MANIFEST_THEME_LWT_ALIAS',\n  '/theme/colors/textcolor': 'MANIFEST_THEME_LWT_ALIAS',\n};\n\n// Mapping of deprecated javascript apis.\n// If the value is `null` we will be using the `deprecated` message\n// from the schema. Otherwise `code`, `message` and `description` will be taken\n// from the object provided.\n// Note that we have to use the constants name as we can't import\n// the message object here.\nexport const DEPRECATED_JAVASCRIPT_APIS = {\n  // These APIs were already deprecated by Chrome and Firefox never\n  // supported them. We do still issue deprecation warnings for them.\n  'app.getDetails': 'DEPRECATED_CHROME_API',\n  'extension.onRequest': 'DEPRECATED_CHROME_API',\n  'extension.onRequestExternal': 'DEPRECATED_CHROME_API',\n  'extension.sendRequest': 'DEPRECATED_CHROME_API',\n  'tabs.getAllInWindow': 'DEPRECATED_CHROME_API',\n  'tabs.getSelected': 'DEPRECATED_CHROME_API',\n  'tabs.onActiveChanged': 'DEPRECATED_CHROME_API',\n  'tabs.onSelectionChanged': 'DEPRECATED_CHROME_API',\n  'tabs.sendRequest': 'DEPRECATED_CHROME_API',\n\n  // https://github.com/mozilla/addons-linter/issues/2556\n  'proxy.register': 'DEPRECATED_API',\n  'proxy.unregister': 'DEPRECATED_API',\n  'proxy.onProxyError': 'DEPRECATED_API',\n  'proxy.registerProxyScript': 'DEPRECATED_API',\n};\n\n// A list of magic numbers that we won't allow.\nexport const FLAGGED_FILE_MAGIC_NUMBERS = [\n  [0x4d, 0x5a], // EXE or DLL,\n  [0x5a, 0x4d], // Alternative EXE or DLL\n  [0x7f, 0x45, 0x4c, 0x46], // UNIX elf\n  [0x23, 0x21], // Shell script\n  [0xca, 0xfe, 0xba, 0xbe], // Java + Mach-O (dylib)\n  [0xca, 0xfe, 0xd0, 0x0d], // Java packed\n  [0x43, 0x57, 0x53], // Compressed SWF\n];\n\n// These are APIs that will cause problems when loaded temporarily\n// in about:debugging.\n// APIs listed here should be defined in https://mzl.la/31p4AMc\nexport const TEMPORARY_APIS = [\n  'identity.getRedirectURL',\n  'storage.sync',\n  'storage.managed',\n  'runtime.onMessageExternal',\n  'runtime.onConnectExternal',\n];\n\n// All valid CSP keywords that are options to keys like `default-src` and\n// `script-src`. Used in manifest.json parser for validation.\n// See https://mzl.la/2vwqbGU for more details and allowed options.\nexport const CSP_KEYWORD_RE = new RegExp(\n  [\n    '(self|none|unsafe-inline|strict-dynamic|unsafe-hashed-attributes)',\n    // Only match these keywords, anything else is forbidden\n    '(?!.)',\n    '|(sha(256|384|512)-|nonce-)',\n  ].join('')\n);\n\nexport const MESSAGES_JSON = 'messages.json';\nexport const LOCALES_DIRECTORY = '_locales';\n\n// This is a string, since it has to be matched globally on a message string.\n// This should match\n// https://searchfox.org/mozilla-central/rev/3abf6fa7e2a6d9a7bfb88796141b0f012e68c2db/toolkit/components/extensions/ExtensionCommon.jsm#1711\nexport const MESSAGE_PLACEHOLDER_REGEXP = '\\\\$([a-zA-Z0-9_@]+)\\\\$';\n\n// yauzl should trow error with this message in case of corrupt zip file\nexport const ZIP_LIB_CORRUPT_FILE_ERROR =\n  'end of central directory record signature not found';\n\n// URLs in this array are restricted from being used in the manifest.json \"homepage_url\" prperty\nexport const RESTRICTED_HOMEPAGE_URLS = [\n  'addons-dev.allizom.org',\n  'addons.mozilla.org',\n];\n\n// This map should contain entries with a permission name as key and a min\n// Firefox version as value (both string values).\nexport const RESTRICTED_PERMISSIONS = new Map([\n  // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1733159\n  ['proxy', '91.1.0'],\n]);\n","import {\n  DEPRECATED_JAVASCRIPT_APIS,\n  TEMPORARY_APIS,\n  MANIFEST_VERSION_DEFAULT,\n  MANIFEST_VERSION_MIN,\n  MANIFEST_VERSION_MAX,\n} from 'const';\nimport schemaList from 'schema/imported';\n\nconst schemaArrayNames = ['functions', 'events'];\nconst schemaObjectNames = ['types', 'properties'];\nconst schemas = schemaList.reduce(\n  (all, current) => ({\n    ...all,\n    [current.id]: current,\n  }),\n  {}\n);\n\nfunction getObjectProperty(schema, property) {\n  for (const schemaProperty of schemaObjectNames) {\n    if (\n      schema &&\n      schema[schemaProperty] &&\n      property in schema[schemaProperty]\n    ) {\n      return schema[schemaProperty][property];\n    }\n  }\n  return null;\n}\n\nfunction getArrayProperty(schema, property) {\n  for (const schemaProperty of schemaArrayNames) {\n    if (schema && schemaProperty in schema) {\n      const namespaceProperties = schema[schemaProperty];\n      if (Array.isArray(namespaceProperties)) {\n        for (const schemaItem of namespaceProperties) {\n          if (schemaItem.name === property) {\n            return schemaItem;\n          }\n        }\n      }\n    }\n  }\n  return null;\n}\n\nexport function getManifestVersion(addonMetadata) {\n  const { manifestVersion } = addonMetadata || {\n    manifestVersion: MANIFEST_VERSION_DEFAULT,\n  };\n  return manifestVersion;\n}\n\nexport function getMaxManifestVersion(\n  namespace,\n  property,\n  addonMetadata,\n  apiSchemas = schemas\n) {\n  const schema = apiSchemas[namespace];\n  const schemaItem =\n    getObjectProperty(schema, property) || getArrayProperty(schema, property);\n\n  let ns_max_mv = schema && schema.max_manifest_version;\n  ns_max_mv = ns_max_mv == null ? MANIFEST_VERSION_MAX : ns_max_mv;\n\n  let prop_max_mv = schemaItem && schemaItem.max_manifest_version;\n  prop_max_mv = prop_max_mv == null ? MANIFEST_VERSION_MAX : prop_max_mv;\n\n  // Return the lowest max_manifest_version value between the one set at\n  // API namespace level and the one set on the particular property.\n  return Math.min(ns_max_mv, prop_max_mv);\n}\n\nexport function getMinManifestVersion(\n  namespace,\n  property,\n  addonMetadata,\n  apiSchemas = schemas\n) {\n  const schema = apiSchemas[namespace];\n  const schemaItem =\n    getObjectProperty(schema, property) || getArrayProperty(schema, property);\n\n  let ns_min_mv = schema && schema.min_manifest_version;\n  ns_min_mv = ns_min_mv == null ? MANIFEST_VERSION_MIN : ns_min_mv;\n\n  let prop_min_mv = schemaItem && schemaItem.min_manifest_version;\n  prop_min_mv = prop_min_mv == null ? MANIFEST_VERSION_MIN : prop_min_mv;\n\n  // Return the highest min_manifest_version value between the one set at\n  // API namespace level and the one set on the particular property.\n  return Math.max(ns_min_mv, prop_min_mv);\n}\n\nexport function isTemporaryApi(namespace, property) {\n  return TEMPORARY_APIS.includes(`${namespace}.${property}`);\n}\n\nexport function isMV2RemovedApi(\n  namespace,\n  property,\n  addonMetadata,\n  apiSchemas = schemas\n) {\n  // The message for API deprecated in manifest_version 3 should not be\n  // used if the currently validated addon has manifest_version 2.\n  if (addonMetadata.manifestVersion === 2) {\n    return false;\n  }\n\n  return (\n    getMaxManifestVersion(namespace, property, addonMetadata, apiSchemas) === 2\n  );\n}\n\nexport function isInSupportedManifestVersionRange(\n  namespace,\n  property,\n  addonMetadata,\n  apiSchemas = schemas\n) {\n  const manifestVersion = getManifestVersion(addonMetadata);\n  const min_manifest_version = getMinManifestVersion(\n    namespace,\n    property,\n    addonMetadata,\n    apiSchemas\n  );\n  const max_manifest_version = getMaxManifestVersion(\n    namespace,\n    property,\n    addonMetadata,\n    apiSchemas\n  );\n\n  // The API isn't in a supported manifest version range if its schema entry has a\n  // min_manifest_version greater than the extension manifest version or a\n  // max_manifest_version lower than the extension manifest version.\n  if (\n    manifestVersion < min_manifest_version ||\n    manifestVersion > max_manifest_version\n  ) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isDeprecatedApi(\n  namespace,\n  property,\n  addonMetadata,\n  apiSchemas = schemas\n) {\n  // If the API has been removed in a certain manifest version, or only\n  // available starting from a manifest version, then it is unsupported\n  // and not deprecated.\n  if (\n    !isInSupportedManifestVersionRange(\n      namespace,\n      property,\n      addonMetadata,\n      apiSchemas\n    )\n  ) {\n    return false;\n  }\n\n  const schema = apiSchemas[namespace];\n  const schemaItem =\n    getObjectProperty(schema, property) || getArrayProperty(schema, property);\n\n  return (\n    (schemaItem !== null && schemaItem.deprecated !== undefined) ||\n    Object.prototype.hasOwnProperty.call(\n      DEPRECATED_JAVASCRIPT_APIS,\n      `${namespace}.${property}`\n    )\n  );\n}\n\nexport function hasBrowserApi(\n  namespace,\n  property,\n  addonMetadata,\n  apiSchemas = schemas\n) {\n  // We \"have\" the API if it's deprecated or temporary so we don't double warn.\n  if (\n    isTemporaryApi(namespace, property) ||\n    isDeprecatedApi(namespace, property, addonMetadata, apiSchemas)\n  ) {\n    return true;\n  }\n\n  // We don't have the API if the extension manifest_version is outside of the\n  // manifest_version range where the API is actually supported for.\n  if (\n    !isInSupportedManifestVersionRange(\n      namespace,\n      property,\n      addonMetadata,\n      apiSchemas\n    )\n  ) {\n    return false;\n  }\n\n  // Or the schema entry for the API has an unsupported property set to true.\n  const schema = apiSchemas[namespace];\n  const schemaItem =\n    getObjectProperty(schema, property) || getArrayProperty(schema, property);\n\n  return schemaItem && !schemaItem.unsupported;\n}\n","// This file is generated by the schema import script.\n\nimport activityLog from './activity_log.json';\nimport alarms from './alarms.json';\nimport bookmarks from './bookmarks.json';\nimport action from './action.json';\nimport browserAction from './browser_action.json';\nimport browserSettings from './browser_settings.json';\nimport browsingData from './browsing_data.json';\nimport captivePortal from './captive_portal.json';\nimport chrome_settings_overrides from './chrome_settings_overrides.json';\nimport clipboard from './clipboard.json';\nimport commands from './commands.json';\nimport contentScripts from './content_scripts.json';\nimport contextualIdentities from './contextual_identities.json';\nimport cookies from './cookies.json';\nimport devtools from './devtools.json';\nimport dns from './dns.json';\nimport downloads from './downloads.json';\nimport events from './events.json';\nimport experiments from './experiments.json';\nimport extension from './extension.json';\nimport extension_protocol_handlers from './extension_protocol_handlers.json';\nimport extensionTypes from './extension_types.json';\nimport find from './find.json';\nimport geckoProfiler from './geckoProfiler.json';\nimport history from './history.json';\nimport i18n from './i18n.json';\nimport identity from './identity.json';\nimport idle from './idle.json';\nimport management from './management.json';\nimport contextMenus from './context_menus.json';\nimport menus from './menus.json';\nimport native_manifest from './native_manifest.json';\nimport networkStatus from './network_status.json';\nimport normandyAddonStudy from './normandyAddonStudy.json';\nimport notifications from './notifications.json';\nimport omnibox from './omnibox.json';\nimport pageAction from './page_action.json';\nimport permissions from './permissions.json';\nimport pkcs11 from './pkcs11.json';\nimport privacy from './privacy.json';\nimport proxy from './proxy.json';\nimport runtime from './runtime.json';\nimport search from './search.json';\nimport sessions from './sessions.json';\nimport sidebarAction from './sidebar_action.json';\nimport storage from './storage.json';\nimport tabs from './tabs.json';\nimport telemetry from './telemetry.json';\nimport test from './test.json';\nimport theme from './theme.json';\nimport topSites from './top_sites.json';\nimport types from './types.json';\nimport url_overrides from './url_overrides.json';\nimport urlbar from './urlbar.json';\nimport userScripts from './userScripts.json';\nimport webNavigation from './web_navigation.json';\nimport webRequest from './web_request.json';\nimport windows from './windows.json';\nexport default [\n  activityLog,\n  alarms,\n  bookmarks,\n  action,\n  browserAction,\n  browserSettings,\n  browsingData,\n  captivePortal,\n  chrome_settings_overrides,\n  clipboard,\n  commands,\n  contentScripts,\n  contextualIdentities,\n  cookies,\n  devtools,\n  dns,\n  downloads,\n  events,\n  experiments,\n  extension,\n  extension_protocol_handlers,\n  extensionTypes,\n  find,\n  geckoProfiler,\n  history,\n  i18n,\n  identity,\n  idle,\n  management,\n  contextMenus,\n  menus,\n  native_manifest,\n  networkStatus,\n  normandyAddonStudy,\n  notifications,\n  omnibox,\n  pageAction,\n  permissions,\n  pkcs11,\n  privacy,\n  proxy,\n  runtime,\n  search,\n  sessions,\n  sidebarAction,\n  storage,\n  tabs,\n  telemetry,\n  test,\n  theme,\n  topSites,\n  types,\n  url_overrides,\n  urlbar,\n  userScripts,\n  webNavigation,\n  webRequest,\n  windows,\n];\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { isTemporaryApi } from 'schema/browser-apis';\nimport { apiToMessage, isBrowserNamespace } from 'utils';\n\nconst rule = {\n  create(context) {\n    return {\n      // eslint-disable-next-line consistent-return\n      MemberExpression(node) {\n        if (node.object.object && isBrowserNamespace(node.object.object.name)) {\n          const namespace = node.object.property.name;\n          const property = node.property.name;\n          const api = `${namespace}.${property}`;\n\n          if (\n            !context.settings.addonMetadata.id &&\n            isTemporaryApi(namespace, property)\n          ) {\n            return context.report(node, apiToMessage(api));\n          }\n        }\n      },\n    };\n  },\n};\n\nexport default rule;\nexport const { create } = rule;\n"],"names":["SOURCE_MAP_RE","AddonsLinterUserError","Error","name","errorParamsToUnsupportedVersionRange","errorParams","min_manifest_version","max_manifest_version","undefined","filter","e","join","normalizePath","iconPath","pathname","URL","upath","toUnix","decodeURIComponent","slice","getRootExpression","node","root","callee","type","parent","object","getNodeReference","context","variables","getScope","scopeVar","i","length","variable","defs","body","occurances","lastAssignment","Array","forEach","occurance","declarations","init","expression","right","getVariable","result","getLocale","osLocale","sync","getI18Data","locale","i18ndata","nodeRequire","localesRoot","err","log","info","buildI18nObject","i18nData","_jed","Jed","jed","_","str","gettext","sprintf","fmt","args","i18n","checkMinNodeVersion","minVersion","_process","process","semver","gte","version","getPackageTypeAsString","numericPackageType","packageKeys","Object","keys","PACKAGE_TYPES","packageType","parseInt","ignorePrivateFunctions","list","filteredList","functionName","startsWith","ensureFilenameExists","filename","isLocalUrl","urlInput","parsedUrl","url","parse","protocol","path","LOCAL_PROTOCOLS","includes","apiToMessage","string","replace","toUpperCase","substr","isBrowserNamespace","parseCspPolicy","policy","toLowerCase","parsedPolicy","directives","split","directive","trim","tokens","getLineAndColumnFromMatch","match","matchedLines","input","index","matchedColumn","matchedLine","couldBeMinifiedCode","code","test","sampleSize","indentCountThreshold","hugeLinesLength","hugeLinesThreshold","lineEndIndex","lineStartIndex","lines","indentCount","hugeLinesCount","normalizedCode","indexOf","currentLine","firefoxStrictMinVersion","manifestJson","applications","gecko","strict_min_version","basicCompatVersionComparison","versionAdded","asNumber","Number","isNaN","firstStableVersion","supportInfo","supportInfoArray","isArray","reduce","supportEntry","prototype","hasOwnProperty","call","version_added","isCompatible","bcd","application","steps","api","webextensions","step","__compat","support","createCompatibilityRule","message","hasBrowserApi","addonMetadata","settings","firefoxMinVersion","MemberExpression","computed","namespace","property","report","messageFormat","createLogger","level","env","LOG_LEVEL","stdout","ESLINT_ERROR","ESLINT_WARNING","NO_UNSANITIZED_OPTIONS","variableTracing","escape","taggedTemplates","methods","EXTERNAL_RULE_MAPPING","allowIndirect","ESLINT_RULE_MAPPING","VALIDATION_ERROR","VALIDATION_NOTICE","VALIDATION_WARNING","ESLINT_TYPES","MESSAGE_TYPES","PACKAGE_ANY","PACKAGE_EXTENSION","PACKAGE_THEME","PACKAGE_DICTIONARY","PACKAGE_LANGPACK","PACKAGE_SEARCHPROV","PACKAGE_MULTI","PACKAGE_SUBPACKAGE","MANIFEST_JSON","MANIFEST_VERSION_DEFAULT","MANIFEST_VERSION_MIN","MANIFEST_VERSION_MAX","MAX_FILE_SIZE_TO_PARSE_MB","HIDDEN_FILE_REGEX","FLAGGED_FILE_REGEX","ALREADY_SIGNED_REGEX","PERMS_DATAPATH_REGEX","RESERVED_FILENAMES","FLAGGED_FILE_EXTENSIONS","IMAGE_FILE_EXTENSIONS","FILE_EXTENSIONS_TO_MIME","svg","gif","jpg","jpeg","png","webp","STATIC_THEME_IMAGE_MIMES","Set","values","DEPRECATED_MANIFEST_PROPERTIES","DEPRECATED_JAVASCRIPT_APIS","FLAGGED_FILE_MAGIC_NUMBERS","TEMPORARY_APIS","CSP_KEYWORD_RE","RegExp","MESSAGES_JSON","LOCALES_DIRECTORY","MESSAGE_PLACEHOLDER_REGEXP","ZIP_LIB_CORRUPT_FILE_ERROR","RESTRICTED_HOMEPAGE_URLS","RESTRICTED_PERMISSIONS","Map","schemaArrayNames","schemaObjectNames","schemas","schemaList","all","current","id","getObjectProperty","schema","schemaProperty","getArrayProperty","namespaceProperties","schemaItem","getManifestVersion","manifestVersion","getMaxManifestVersion","apiSchemas","ns_max_mv","prop_max_mv","Math","min","getMinManifestVersion","ns_min_mv","prop_min_mv","max","isTemporaryApi","isMV2RemovedApi","isInSupportedManifestVersionRange","isDeprecatedApi","deprecated","unsupported","activityLog","alarms","bookmarks","action","browserAction","browserSettings","browsingData","captivePortal","chrome_settings_overrides","clipboard","commands","contentScripts","contextualIdentities","cookies","devtools","dns","downloads","events","experiments","extension","extension_protocol_handlers","extensionTypes","find","geckoProfiler","history","identity","idle","management","contextMenus","menus","native_manifest","networkStatus","normandyAddonStudy","notifications","omnibox","pageAction","permissions","pkcs11","privacy","proxy","runtime","search","sessions","sidebarAction","storage","tabs","telemetry","theme","topSites","types","url_overrides","urlbar","userScripts","webNavigation","webRequest","windows","rule","create"],"sourceRoot":""}