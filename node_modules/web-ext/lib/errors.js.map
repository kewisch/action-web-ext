{"version":3,"file":"errors.js","names":["ExtendableError","WebExtError","constructor","message","UsageError","InvalidManifest","RemoteTempInstallNotSupported","MultiExtensionsReloadError","errorsMap","errors","sourceDir","error","msg","String","errorsBySourceDir","onlyInstancesOf","predicate","errorHandler","onlyErrorsWithCode","codeWanted","throwError","Array","isArray","indexOf","code","errno","isErrorWithCode"],"sources":["../src/errors.js"],"sourcesContent":["/* @flow */\nimport ExtendableError from 'es6-error';\n\n\n/*\n * Base error for all custom web-ext errors.\n */\nexport class WebExtError extends ExtendableError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n\n/*\n * The class for errors that can be fixed by the developer.\n */\nexport class UsageError extends WebExtError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n\n/*\n * The manifest for the extension is invalid (or missing).\n */\nexport class InvalidManifest extends UsageError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n\n/*\n * The remote Firefox does not support temporary add-on installation.\n */\nexport class RemoteTempInstallNotSupported extends WebExtError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n/*\n * The errors collected when reloading all extensions at once\n * (initialized from a map of errors by extensionSourceDir string).\n */\nexport class MultiExtensionsReloadError extends WebExtError {\n  constructor(errorsMap: Map<string, Error>) {\n    let errors = '';\n    for (const [sourceDir, error] of errorsMap) {\n      const msg = String(error);\n      errors += `\\nError on extension loaded from ${sourceDir}: ${msg}\\n`;\n    }\n    const message = `Reload errors: ${errors}`;\n\n    super(message);\n    this.errorsBySourceDir = errorsMap;\n  }\n}\n\n/*\n * Sugar-y way to catch only instances of a certain error.\n *\n * Usage:\n *\n *  Promise.reject(SyntaxError)\n *    .catch(onlyInstancesOf(SyntaxError, (error) => {\n *      // error is guaranteed to be an instance of SyntaxError\n *    }))\n *\n * All other errors will be re-thrown.\n *\n */\nexport function onlyInstancesOf(\n  predicate: Function, errorHandler: Function\n): Function {\n  return (error) => {\n    if (error instanceof predicate) {\n      return errorHandler(error);\n    } else {\n      throw error;\n    }\n  };\n}\n\n\n/*\n * Sugar-y way to catch only errors having certain code(s).\n *\n * Usage:\n *\n *  Promise.resolve()\n *    .catch(onlyErrorsWithCode('ENOENT', (error) => {\n *      // error.code is guaranteed to be ENOENT\n *    }))\n *\n *  or:\n *\n *  Promise.resolve()\n *    .catch(onlyErrorsWithCode(['ENOENT', 'ENOTDIR'], (error) => {\n *      // ...\n *    }))\n *\n * All other errors will be re-thrown.\n *\n */\nexport function onlyErrorsWithCode(\n  codeWanted: (string | number) | Array<string | number>,\n  errorHandler: Function\n): Function {\n  return (error) => {\n    let throwError = true;\n\n    if (Array.isArray(codeWanted)) {\n      if (codeWanted.indexOf(error.code) !== -1 ||\n          codeWanted.indexOf(error.errno) !== -1) {\n        throwError = false;\n      }\n    } else if (error.code === codeWanted || error.errno === codeWanted) {\n      throwError = false;\n    }\n\n    if (throwError) {\n      throw error;\n    }\n\n    return errorHandler(error);\n  };\n}\n\nexport function isErrorWithCode(\n  codeWanted: string | Array<string>,\n  error: Object,\n): boolean {\n  if (Array.isArray(codeWanted) && codeWanted.indexOf(error.code) !== -1) {\n    return true;\n  } else if (error.code === codeWanted) {\n    return true;\n  }\n\n  return false;\n}\n"],"mappings":"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"}